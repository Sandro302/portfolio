# Functional Requirements — Engineering Calculation System

Функциональные требования к системе расчёта и визуализации параметров трубопровода.

---

## FR-01. Управление проектами

Система должна предоставлять возможность:

1. Создавать новый пустой проект.
2. Импортировать проект из OLGA (см. UC01).
3. Просматривать список проектов с основными атрибутами:
   - имя,
   - дата создания,
   - статус,
   - статус последнего расчёта.
4. Открывать детали проекта:
   - топология (узлы, трубы),
   - список расчётов,
   - лог импортов/ошибок.
5. Удалять проект (если нет активных расчётов или по политике).

---

## FR-02. Импорт проектов из OLGA

Система должна:

1. Принимать от пользователя один или несколько файлов проекта OLGA.
2. Валидировать формат и структуру файлов.
3. Создавать запись о проекте в БД.
4. Импортировать:
   - узлы,
   - трубопроводные сегменты,
   - ключевые параметры (в соответствии с поддерживаемой моделью).
5. Логировать факт импорта и его статус в IMPORT_LOGS.
6. Возвращать пользователю результат импорта:
   - projectId,
   - статус,
   - список предупреждений/ошибок.

(Подробности поведения см. UC01.)

---

## FR-03. Настройка параметров расчёта

Система должна:

1. Предоставлять экран/форму настройки параметров расчёта:
   - давления,
   - температуры,
   - дебиты,
   - режимы работы и пр. (по домену).
2. Поддерживать шаблоны расчётных параметров:
   - создание, редактирование, удаление,
   - пометка шаблона как «по умолчанию» для проекта.
3. Позволять пользователю запускать расчёт:
   - на основе выбранного шаблона,
   - с возможностью переопределения отдельных параметров.

(Связано с UC02 и UC06.)

---

## FR-04. Запуск и управление расчётами

Система должна:

1. Принимать команду запуска расчёта через UI/API.
2. Создавать запись в CALCULATIONS со статусом `queued`.
3. Передавать задание в расчётный модуль (через очередь или сервис).
4. Обновлять статус расчёта:
   - `queued` → `running` → `completed` или `failed`.
5. Сохранять время начала и окончания расчёта.
6. Логировать ошибки и предупреждения.
7. Обеспечивать возможность получить список расчётов для проекта.

(Подробности поведения см. UC02.)

---

## FR-05. Хранение и выдача результатов

Система должна:

1. Сохранять результаты расчётов в структуре:
   - по узлам (NODES),
   - по сегментам (PIPES),
   - с основными параметрами (давление, температура, расход и др.).
2. Предоставлять API/функциональность UI для:
   - получения результатов последнего успешного расчёта,
   - получения результатов выбранного расчёта.
3. Обеспечивать возможность построения:
   - графиков по трассе (профили),
   - таблиц по узлам/сегментам.

(Связано с UC03.)

---

## FR-06. Просмотр результатов в UI

Система должна:

1. Отображать схему трубопровода с привязкой к узлам и сегментам.
2. Позволять пользователю:
   - выбирать расчёт,
   - выбирать отображаемый параметр (давление, температура, дебит и др.),
   - просматривать значения по узлам/сегментам.
3. Отображать:
   - графики (профили) по длине трассы,
   - таблицы значений.
4. Отображать предупреждения, связанные с расчётом (если есть).

(UC03.)

---

## FR-07. Экспорт результатов

Система должна:

1. Обеспечивать экспорт результатов в CSV/табличный формат.
2. Позволять пользователю:
   - выбрать проект и расчёт,
   - запустить экспорт.
3. Формировать файл, содержащий:
   - идентификаторы узлов/сегментов,
   - значения параметров,
   - при необходимости — метаинформацию (единицы измерения и др.).
4. Выдавать файл пользователю через UI.

(UC04, см. BPMN_03_Export_Process.)

---

## FR-08. Управление шаблонами

Система должна:

1. Позволять создавать новые шаблоны расчётов:
   - имя,
   - описание,
   - набор параметров.
2. Позволять редактировать и удалять шаблоны.
3. Позволять помечать шаблон как шаблон по умолчанию.
4. Хранить шаблоны на уровне проекта (или глобально — по политике).

(UC06.)

---

## FR-09. Логирование операций и ошибок

Система должна:

1. Вести лог импортов в IMPORT_LOGS.
2. Вести лог ошибок и важных событий в ERROR_LOGS.
3. Предоставлять базовые средства просмотра логов (для поддержки/администраторов).

---

## FR-10. API‑доступ

Система должна предоставлять REST API для основных операций:

- управление проектами,
- импорт,
- запуск расчётов,
- получение результатов,
- экспорт.

Подробная спецификация описана в `06_API_Specification/API_Spec.yaml`.

---
